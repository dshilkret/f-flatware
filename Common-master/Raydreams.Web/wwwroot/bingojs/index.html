<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><META NAME="Description" CONTENT="Todd A. Guillory's BINGO Hopper"><META NAME="Keywords" CONTENT="bingo,hopper,generator,javascript"><META NAME="Author" CONTENT="Todd A. Guillory"><META NAME="Generator" CONTENT="BBEdit"><HEAD><TITLE>Raydreams BINGO</TITLE></HEAD><SCRIPT LANGUAGE="Javascript"><!--/********************************************************************************* bingojs* created 2002-Sep-13* update  2002-Sep-14*********************************************************************************** COPYRIGHT NOTICE                                                     * Copyright (C) 2002 Todd A. Guillory                           ********************************************************************************/var headers = new Array('B','I','N','G','O');var hopper= new Array(75);var gThread = 0;		// currently running threadvar gHarass = false; 	// just for fun// output imagesvar gLetterImg = new Image();var gTensImg = new Image();var gOnesImg = new Image();var letterImg = new Array(5);var numberImg = new Array(10);/******************************************************************************* ResetBoard*******************************************************************************/function ResetBoard(){	// kill any previous threads	clearTimeout(gThread);		// reset hopper array size	if (hopper.length != 75 )		hopper.length = 75;		// reset the hopper and the board	var k = 0; // hopper index	for (i = 0; i < 5; ++i) // loop each header letter	{		for (j = 0; j < 15; ++j, ++k) // loop each number		{			hopper[k] = new String(headers[i]);			// number must match its header row			var n = (j + 1) + (i * 15);			// add a preceeding 0 if necessary			hopper[k] += (n > -1 && n < 10) ? '0' : '';			hopper[k] += n;						// reset all background colors			ChangeColor(hopper[k],'white');		}	}	// shuffle the hopper	for (var i = 0; i < hopper.length; ++i)	{		// random(0.0 - 0.999) * range_of values + min_value		var p = Math.floor( (Math.random() * (hopper.length - i) ) + i )				// swap		var temp = hopper[i];		hopper[i] = hopper[p];		hopper[p] = temp;	}	// reset output images	gLetterImg.src = 'blank.jpg';	gTensImg.src = 'blank.jpg';	gOnesImg.src = 'blank.jpg';} // end ResetBoard// init the hopper and board on load/******************************************************************************* LoadImages*******************************************************************************/function LoadImages(){	// set display image pointers	gLetterImg = document.imgLetter;	gTensImg = document.imgTens;	gOnesImg = document.imgOnes;		// preload letters	for (var i = 0; i < letterImg.length; ++i)	{		letterImg[i] = new Image();		letterImg[i].src = headers[i] + '.jpg';	}		// preload numbers	for (var i = 0; i < numberImg.length; ++i)	{		numberImg[i] = new Image();		numberImg[i].src = i + '.jpg';	}}/******************************************************************************* ConfirmReset*******************************************************************************/function ConfirmReset(){	if ( confirm('Do you want to reset the game?') )		ResetBoard();		if (gHarass)	{		if ( confirm('No, seriously, are you sure you want to reset?') )			ResetBoard();	}	return;}/******************************************************************************* Draw*******************************************************************************/function Draw(inForm){	if ( hopper.length <= 0 )	{		alert("All numbers drawn! Reset!");		return;	}		// draw by popping the next number off the hopper	if ( Array.pop )		var ball = hopper.pop();	else		var ball = Pop(hopper);	// set output text string	var outStr = ball.charAt(0);	outStr += ' '; 	outStr += ball.charAt(1);	outStr += ball.charAt(2);	inForm.output.value = outStr;		// set output text images	gLetterImg.src = ball.charAt(0) + '.jpg';	gTensImg.src = ball.charAt(1) + '.jpg';	gOnesImg.src = ball.charAt(2) + '.jpg';		// blink cell	gThread = Blink(ball);	// mark the board	//ChangeColor(ball, '#FFCC00');		return;}/******************************************************************************* ChangeColor*******************************************************************************/function ChangeColor(inCell, inColor){	var cell = document.getElementById(inCell);	cell.style.backgroundColor = inColor;}/******************************************************************************* Blink*******************************************************************************/function Blink(inCell){	var intrvl = 0;	var id;			for (nTimes = 0; nTimes < 5; nTimes++)	{		intrvl += 200;		id = setTimeout("ChangeColor('" + inCell + "','#FF0000');", intrvl);				intrvl += 200;				id = setTimeout("ChangeColor('" + inCell + "','#FFCC00');", intrvl);	}		return id;}/******************************************************************************* Pop  remove and return the last element of an array*******************************************************************************/function Pop(a){	if (!a.length > 0)		return null;		var temp = a[(a.length)-1];	--a.length;		return temp;}// End --></SCRIPT><BODY STYLE="background-color: black" onload="LoadImages();ResetBoard();"><FORM NAME="bingo"><TABLE WIDTH="600" CELLPADDING="0" CELLSPACING="0" STYLE="background-color: white; border: 5px solid #FF3399 ridge"><TR><TD COLSPAN="2"><IMG SRC="banner.jpg" BORDER="0" WIDTH="600" HEIGHT="130"></TD></TR><!-- Display Row --><TR><TD COLSPAN="2"><IMG SRC="display_left.jpg" WIDTH="135" HEIGHT="140" BORDER="0"><IMG SRC="blank.jpg" WIDTH="110" HEIGHT="140" BORDER="0" NAME="imgLetter"><IMG SRC="blank.jpg" WIDTH="110" HEIGHT="140" BORDER="0" NAME="imgTens"><IMG SRC="blank.jpg" WIDTH="110" HEIGHT="140" BORDER="0" NAME="imgOnes"><IMG SRC="display_right.jpg" WIDTH="135" HEIGHT="140" BORDER="0"></TD></TR><TR><TD COLSPAN="2"><!-- numbers table --><TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="1" STYLE="background-color: #CCCCCC; font-size: large; font-family: sans-serif; text-align: center"><TR><TD WIDTH="36"><IMG SRC="b_icon.gif" BORDER="0" WIDTH="36" HEIGHT="36"></TD><TD ID="B01">01</TD><TD ID="B02">02</TD><TD ID="B03">03</TD><TD ID="B04">04</TD><TD ID="B05">05</TD><TD ID="B06">06</TD><TD ID="B07">07</TD><TD ID="B08">08</TD><TD ID="B09">09</TD><TD ID="B10">10</TD><TD ID="B11">11</TD><TD ID="B12">12</TD><TD ID="B13">13</TD><TD ID="B14">14</TD><TD ID="B15">15</TD></TR><TR><TD WIDTH="36"><IMG SRC="i_icon.gif" BORDER="0" WIDTH="36" HEIGHT="36"></TD><TD ID="I16">16</TD><TD ID="I17">17</TD><TD ID="I18">18</TD><TD ID="I19">19</TD><TD ID="I20">20</TD><TD ID="I21">21</TD><TD ID="I22">22</TD><TD ID="I23">23</TD><TD ID="I24">24</TD><TD ID="I25">25</TD><TD ID="I26">26</TD><TD ID="I27">27</TD><TD ID="I28">28</TD><TD ID="I29">29</TD><TD ID="I30">30</TD></TR><TR><TD WIDTH="36"><IMG SRC="n_icon.gif" BORDER="0" WIDTH="36" HEIGHT="36"></TD><TD ID="N31">31</TD><TD ID="N32">32</TD><TD ID="N33">33</TD><TD ID="N34">34</TD><TD ID="N35">35</TD><TD ID="N36">36</TD><TD ID="N37">37</TD><TD ID="N38">38</TD><TD ID="N39">39</TD><TD ID="N40">40</TD><TD ID="N41">41</TD><TD ID="N42">42</TD><TD ID="N43">43</TD><TD ID="N44">44</TD><TD ID="N45">45</TD></TR><TR><TD WIDTH="36"><IMG SRC="g_icon.gif" BORDER="0" WIDTH="36" HEIGHT="36"></TD><TD ID="G46">46</TD><TD ID="G47">47</TD><TD ID="G48">48</TD><TD ID="G49">49</TD><TD ID="G50">50</TD><TD ID="G51">51</TD><TD ID="G52">52</TD><TD ID="G53">53</TD><TD ID="G54">54</TD><TD ID="G55">55</TD><TD ID="G56">56</TD><TD ID="G57">57</TD><TD ID="G58">58</TD><TD ID="G59">59</TD><TD ID="G60">60</TD></TR><TR><TD WIDTH="36"><IMG SRC="o_icon.gif" BORDER="0" WIDTH="36" HEIGHT="36"></TD><TD ID="O61">61</TD><TD ID="O62">62</TD><TD ID="O63">63</TD><TD ID="O64">64</TD><TD ID="O65">65</TD><TD ID="O66">66</TD><TD ID="O67">67</TD><TD ID="O68">68</TD><TD ID="O69">69</TD><TD ID="O70">70</TD><TD ID="O71">71</TD><TD ID="O72">72</TD><TD ID="O73">73</TD><TD ID="O74">74</TD><TD ID="O75">75</TD></TR></TD></TR></TABLE><!-- end numbers table --><TR HEIGHT="30" BGCOLOR="#FF0202"><TD WIDTH="200">&nbsp;<INPUT TYPE="BUTTON" VALUE="Draw" ONCLICK="Draw(this.form);"> <INPUT TYPE="TEXT" SIZE="5" NAME="output" READONLY> <INPUT TYPE="BUTTON" VALUE="Reset" ONCLICK="ConfirmReset();"></TD><TD WIDTH="400"><A HREF="http://www.raydreams.com" TARGET="_blank"><IMG SRC="footer.gif" BORDER="0" WIDTH="400" HEIGHT="30"></A></TD></TR></TABLE></FORM><!--<SCRIPT LANGUAGE="javascript">for (var i = 0; i < hopper.length; ++i)	{		document.write('<BR>');		document.write(i);		document.write('=');		document.write(hopper[i]);	}	</SCRIPT>--></BODY></HTML>